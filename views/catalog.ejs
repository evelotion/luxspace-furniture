<%- include('partials/header') %>

<div class="pt-32 pb-10 bg-[#FDFBF7]">
  <div class="container mx-auto px-6" data-aos="fade-up">
    <div class="text-xs text-gray-400 uppercase tracking-widest mb-4">
      <a href="/" class="hover:text-yellow-600 transition">Home</a> / 
      <span class="text-gray-600 font-bold">Catalog</span>
    </div>

    <div class="flex flex-col md:flex-row justify-between items-end gap-6">
      <h1 class="text-4xl md:text-5xl font-serif text-gray-900">
        <%= currentCategory === 'All' ? 'All Collections' : currentCategory + ' Collection' %>
      </h1>

      <div class="flex flex-wrap gap-3">
        <a href="/product" 
           class="px-6 py-2 rounded-full text-xs font-bold uppercase tracking-widest border transition duration-300 
           <%= currentCategory === 'All' 
               ? 'bg-gray-900 text-white border-gray-900' 
               : 'bg-white text-gray-500 border-gray-200 hover:border-gray-900 hover:text-gray-900' %>">
           All
        </a>

        <% categories.forEach(cat => { %>
          <a href="/product?category=<%= cat.category %>" 
             class="px-6 py-2 rounded-full text-xs font-bold uppercase tracking-widest border transition duration-300 
             <%= currentCategory === cat.category 
                 ? 'bg-gray-900 text-white border-gray-900' 
                 : 'bg-white text-gray-500 border-gray-200 hover:border-gray-900 hover:text-gray-900' %>">
             <%= cat.category %>
          </a>
        <% }) %>
      </div>
    </div>

  </div>
</div>

<section id="collection" class="bg-[#FDFBF7] pb-24 relative z-10">
  <div class="container mx-auto px-6">
    
    <% if(products.length === 0) { %>
        <div class="text-center py-20">
            <p class="text-gray-400 text-lg font-serif italic">No products found in this category.</p>
            <a href="/product" class="text-xs font-bold uppercase tracking-widest text-gray-900 border-b border-gray-900 mt-4 inline-block pb-1">View All Products</a>
        </div>
    <% } else { %>

    <div class="columns-1 md:columns-2 lg:columns-3 gap-8 space-y-8 mt-10">
      <% products.forEach((product, index) => { %>

      <div
        class="break-inside-avoid group relative mb-8"
        data-aos="fade-up"
        data-aos-delay="<%= (index % 3) * 100 %>"
      >
        <div
          class="relative overflow-hidden rounded-xl shadow-md group-hover:shadow-2xl transition duration-500 ease-out"
        >
          <a
            href="/product/<%= product.id %>"
            class="absolute inset-0 z-10 cursor-pointer"
          ></a>
          
          <div
            class="absolute top-4 right-4 z-20 opacity-0 group-hover:opacity-100 transition duration-300 translate-y-[-10px] group-hover:translate-y-0"
          >
            <button
              onclick="addToCartAnimated(this, '<%= product.id %>', '<%= product.image_url %>')"
              class="bg-white text-black w-10 h-10 rounded-full flex items-center justify-center hover:bg-yellow-500 hover:text-white shadow-lg transition transform active:scale-90 relative z-30"
            >
              <span class="text-xl leading-none mb-1">+</span>
            </button>
          </div>

          <img
            src="<%= product.image_url %>"
            alt="<%= product.name %>"
            class="w-full object-cover transform group-hover:scale-110 transition duration-[1.5s]"
          />

          <div
            class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition duration-500 pointer-events-none"
          ></div>
        </div>

        <div
          class="mt-4 flex justify-between items-center px-2 group-hover:opacity-50 transition duration-300"
        >
          <div>
            <span class="text-[10px] text-yellow-600 uppercase tracking-widest font-bold block mb-1"><%= product.category %></span>
            <h4 class="text-gray-900 font-serif text-lg">
                <a href="/product/<%= product.id %>"><%= product.name %></a>
            </h4>
          </div>
          <span class="text-sm font-bold text-gray-500">
            <%= new Intl.NumberFormat('id-ID', { style: 'currency', currency:
            'IDR', minimumFractionDigits: 0 }).format(product.price) %>
          </span>
        </div>
      </div>

      <% }) %>
    </div>
    <% } %>
  </div>
</section>

<%- include('partials/footer') %>