<%- include('partials/header') %>

<div class="min-h-screen pt-32 pb-20 relative z-10 bg-[#FDFBF7]">
  <div class="container mx-auto px-6 max-w-5xl">
    <div class="text-center mb-12">
      <h1 class="text-4xl font-serif text-gray-900">Secure Checkout</h1>
      <p class="text-gray-500 text-sm mt-2">Complete your purchase securely.</p>
    </div>

    <form
      action="/checkout/process"
      method="POST"
      class="grid grid-cols-1 lg:grid-cols-12 gap-12"
    >
      <div class="lg:col-span-7 space-y-8">
        <div class="bg-white p-8 rounded-2xl shadow-sm border border-gray-100">
          <h2 class="text-lg font-bold font-serif mb-6 text-gray-900">
            Shipping Details
          </h2>

          <div class="space-y-5">
            <div>
              <label
                class="block text-xs uppercase tracking-widest text-gray-500 mb-2 font-bold"
                >Recipient Name</label
              >
              <input
                type="text"
                value="<%= user.full_name %>"
                readonly
                class="w-full bg-gray-50 border border-gray-200 rounded-lg px-4 py-3 text-gray-500 cursor-not-allowed"
              />
            </div>

            <div>
              <label
                class="block text-xs uppercase tracking-widest text-gray-500 mb-2 font-bold"
                >Phone Number</label
              >
              <input
                type="text"
                name="phone"
                value="<%= user.phone || '' %>"
                placeholder="e.g. 08123456789"
                required
                class="w-full bg-white border border-gray-200 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-yellow-500 transition text-gray-900"
              />
            </div>

            <div>
              <label
                class="block text-xs uppercase tracking-widest text-gray-500 mb-2 font-bold"
                >Shipping Address</label
              >
              <textarea
                name="address"
                required
                rows="3"
                placeholder="Street, City, Zip Code..."
                class="w-full bg-white border border-gray-200 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-yellow-500 transition text-gray-900"
              >
<%= user.address || '' %></textarea
              >
            </div>
          </div>
        </div>

        <div class="bg-white p-8 rounded-2xl shadow-sm border border-gray-100">
          <h2 class="text-lg font-bold font-serif mb-6 text-gray-900">
            Payment Method
          </h2>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <label class="cursor-pointer">
              <input
                type="radio"
                name="payment_method"
                value="va"
                class="peer sr-only"
                checked
              />
              <div
                class="p-4 border border-gray-200 rounded-xl peer-checked:border-yellow-600 peer-checked:bg-yellow-50 hover:bg-gray-50 transition flex items-center gap-3"
              >
                <div
                  class="w-4 h-4 rounded-full border border-gray-400 peer-checked:bg-yellow-600 peer-checked:border-yellow-600"
                ></div>
                <span class="font-medium text-sm text-gray-800"
                  >Virtual Account</span
                >
              </div>
            </label>
            <label class="cursor-pointer">
              <input
                type="radio"
                name="payment_method"
                value="cod"
                class="peer sr-only"
              />
              <div
                class="p-4 border border-gray-200 rounded-xl peer-checked:border-yellow-600 peer-checked:bg-yellow-50 hover:bg-gray-50 transition flex items-center gap-3"
              >
                <div
                  class="w-4 h-4 rounded-full border border-gray-400 peer-checked:bg-yellow-600 peer-checked:border-yellow-600"
                ></div>
                <span class="font-medium text-sm text-gray-800"
                  >Cash on Delivery</span
                >
              </div>
            </label>
          </div>
        </div>
      </div>

      <div class="lg:col-span-5">
        <div
          class="bg-white p-8 rounded-2xl shadow-xl border border-gray-100 sticky top-32"
        >
          <h2 class="text-lg font-bold font-serif mb-6 text-gray-900">
            Order Summary
          </h2>

          <div
            class="space-y-4 mb-6 max-h-60 overflow-y-auto pr-2 custom-scrollbar"
          >
            <% cartItems.forEach(item => { %>
            <div class="flex justify-between items-center text-sm">
              <div class="flex items-center gap-3">
                <div class="relative">
                  <img
                    src="<%= item.image_url %>"
                    class="w-10 h-10 object-cover rounded bg-gray-100"
                  />
                  <span
                    class="absolute -top-1 -right-1 bg-gray-900 text-white text-[10px] w-4 h-4 flex items-center justify-center rounded-full"
                    ><%= item.quantity %></span
                  >
                </div>
                <span class="text-gray-700 font-medium truncate max-w-[120px]"
                  ><%= item.name %></span
                >
              </div>
              <span class="text-gray-900 font-bold">
                <%= new Intl.NumberFormat('id-ID').format(item.subtotal) %>
              </span>
            </div>
            <% }) %>
          </div>

          <div class="border-t border-gray-100 pt-6 space-y-2">
            <div class="flex justify-between text-gray-900 font-bold text-lg">
              <span>Total</span>
              <span
                >IDR <%= new Intl.NumberFormat('id-ID').format(grandTotal)
                %></span
              >
            </div>
          </div>

          <button
            type="submit"
            class="mt-8 w-full bg-gray-900 text-white py-4 rounded-lg text-xs uppercase tracking-[0.2em] font-bold hover:bg-yellow-600 transition shadow-lg"
          >
            Confirm Payment
          </button>

          <p class="text-center text-[10px] text-gray-400 mt-4">
            By clicking confirm, you agree to our Terms & Conditions.
          </p>
        </div>
      </div>
    </form>
  </div>
</div>

<%- include('partials/footer') %>
